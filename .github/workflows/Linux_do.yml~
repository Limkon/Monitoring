name: LinuxDo Automation

on:
  schedule:
    - cron: "0 * */7 * *"  # 每七天的开始时刻运行一次，改为每 7 天运行一次
  workflow_dispatch:  # 手动触发

jobs:
  run-linux-do:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'  # 推荐明确指定版本

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install selenium aiohttp beautifulsoup4 playwright  # 只需要安装一次
        playwright install  # 安装 Playwright 浏览器驱动
        playwright install-deps  # 安装 Chromium 依赖（仅 Linux 需要）

    # 如果需要随机延迟，可以解开下面代码
    #- name: Delay random minutes
    #  run: |
    #    delay=$((RANDOM % 1 + 1))  # 例如：随机延迟 1 分钟
    #    echo "Sleeping for $delay minutes..."
    #    sleep "${delay}m"

    - name: Run Linux_do.py script
      run: python tools/Linux_do.py
